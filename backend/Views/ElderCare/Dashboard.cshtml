@{
    ViewData["Title"] = "Elder Care Dashboard";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var userName = ViewBag.UserName as string ?? "Friend";
    var guardianName = ViewBag.GuardianName as string ?? "Guardian";
    var isMalayalam = System.Globalization.CultureInfo.CurrentUICulture.Name.Equals("ml-IN", StringComparison.OrdinalIgnoreCase);
}

<style>
    /* Elder-friendly large UI styles */
    .elder-dashboard {
        width: 100%;
        margin: 0;
        padding: 20px 30px;
    }
    
    .elder-greeting {
        text-align: center;
        padding: 30px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 20px;
        color: white;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    }
    
    .elder-greeting h1 {
        font-size: 2.5rem;
        font-weight: 600;
        margin-bottom: 10px;
    }
    
    .elder-greeting p {
        font-size: 1.3rem;
        opacity: 0.9;
    }
    
    .elder-buttons-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-bottom: 30px;
    }
    
    /* Responsive grid */
    @@media (max-width: 1200px) {
        .elder-buttons-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }
    
    @@media (max-width: 900px) {
        .elder-buttons-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    
    @@media (max-width: 576px) {
        .elder-buttons-grid {
            grid-template-columns: 1fr;
        }
        .elder-dashboard {
            padding: 15px;
        }
    }
    
    .elder-button {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 35px 25px;
        border-radius: 20px;
        text-decoration: none;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        min-height: 180px;
        text-align: center;
    }
    
    .elder-button:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        text-decoration: none;
    }
    
    .elder-button .icon {
        font-size: 3.5rem;
        margin-bottom: 15px;
    }
    
    .elder-button .label {
        font-size: 1.4rem;
        font-weight: 600;
    }
    
    .elder-button .sublabel {
        font-size: 1rem;
        opacity: 0.8;
        margin-top: 5px;
    }
    
    /* SOS Button - Red & Prominent */
    .btn-sos {
        background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
        color: white;
        border: 3px solid #ff2a00;
        animation: pulse-sos 2s infinite;
    }
    
    .btn-sos:hover {
        color: white;
        background: linear-gradient(135deg, #ff2a00 0%, #ff0000 100%);
    }
    
    @@keyframes pulse-sos {
        0%, 100% { box-shadow: 0 0 0 0 rgba(255, 65, 108, 0.7); }
        50% { box-shadow: 0 0 0 15px rgba(255, 65, 108, 0); }
    }
    
    /* Check-in Button - Green */
    .btn-checkin {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
    }
    
    .btn-checkin:hover {
        color: white;
    }
    
    /* Medicine Button - Blue */
    .btn-medicine {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }
    
    .btn-medicine:hover {
        color: white;
    }
    
    /* Notes Button - Orange */
    .btn-notes {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
    }
    
    .btn-notes:hover {
        color: white;
    }
    
    /* Wellness Button - Teal */
    .btn-wellness {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
    }
    
    .btn-wellness:hover {
        color: white;
    }
    
    /* Guardian Button - Purple */
    .btn-guardian {
        background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
        color: #333;
    }
    
    .btn-guardian:hover {
        color: #333;
    }
    
    /* Edit Profile Button - Gray */
    .btn-editprofile {
        background: linear-gradient(135deg, #bdc3c7 0%, #2c3e50 100%);
        color: white;
    }
    
    .btn-editprofile:hover {
        color: white;
    }

    /* News Button - Blue */
    .btn-news {
        background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        color: white;
    }
    
    .btn-news:hover {
        color: white;
    }
    
    /* Messages Button - Indigo */
    .btn-messages {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }
    
    .btn-messages:hover {
        color: white;
    }
    
    /* Notification Badge */
    .elder-button {
        position: relative;
    }
    
    .notification-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        background: #ef4444;
        color: white;
        border-radius: 50%;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
        font-weight: 700;
        animation: badge-pulse 2s infinite;
        box-shadow: 0 2px 8px rgba(239, 68, 68, 0.5);
    }
    
    .notification-badge.hidden {
        display: none;
    }
    
    @@keyframes badge-pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }
    
    /* Alert text under button */
    .alert-sublabel {
        color: #fbbf24;
        font-weight: 600;
        animation: blink 1.5s infinite;
    }
    
    @@keyframes blink {
        0%, 50%, 100% { opacity: 1; }
        25%, 75% { opacity: 0.5; }
    }
    
    /* Guardian info card */
    .guardian-card {
        background: white;
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .guardian-card .icon {
        font-size: 2rem;
        color: #667eea;
    }
    
    .guardian-card .info h5 {
        margin: 0;
        color: #333;
        font-size: 1.1rem;
    }
    
    .guardian-card .info p {
        margin: 0;
        color: #666;
        font-size: 0.95rem;
    }
    
    /* Success message */
    .elder-success {
        background: #d4edda;
        color: #155724;
        padding: 15px 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        font-size: 1.1rem;
        text-align: center;
    }
    
    /* Mobile responsiveness */
    @@media (max-width: 576px) {
        .elder-greeting h1 {
            font-size: 1.8rem;
        }
        
        .elder-button {
            padding: 25px 20px;
            min-height: 150px;
        }
        
        .elder-button .icon {
            font-size: 2.5rem;
        }
        
        .elder-button .label {
            font-size: 1.2rem;
        }
    }
</style>

<div class="elder-dashboard">
    @if (TempData["Success"] != null)
    {
        <div class="elder-success">
            <i class="fas fa-check-circle me-2"></i>@TempData["Success"]
        </div>
    }

    <div class="elder-greeting">
        <h1>@(isMalayalam ? "‡¥∏‡µç‡¥µ‡¥æ‡¥ó‡¥§‡¥Ç" : "Welcome"), @userName! üëã</h1>
        <p>@(isMalayalam ? "‡¥á‡¥®‡µç‡¥®‡µç ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥é‡¥ô‡µç‡¥ô‡¥®‡µÜ ‡¥∏‡¥π‡¥æ‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥®‡¥æ‡¥ï‡µÅ‡¥Ç?" : "How can we help you today?")</p>
    </div>
    
    <!-- Guardian Info Card -->
    <div class="guardian-card mb-4">
        <div class="icon">
            <i class="fas fa-user-shield"></i>
        </div>
        <div class="info">
            <h5>@(isMalayalam ? "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∞‡¥ï‡µç‡¥∑‡¥æ‡¥ß‡¥ø‡¥ï‡¥æ‡¥∞‡¥ø" : "Your Guardian")</h5>
            <p>@guardianName ‚Ä¢ @ViewBag.GuardianPhone</p>
        </div>
    </div>

    <div class="elder-buttons-grid">
        <!-- Emergency SOS -->
        <a href="@Url.Action("EmergencySOS", "ElderCare")" class="elder-button btn-sos">
            <span class="icon">üÜò</span>
            <span class="label">@(isMalayalam ? "‡¥Ö‡¥ü‡¥ø‡¥Ø‡¥®‡µç‡¥§‡¥∞ SOS" : "Emergency SOS")</span>
            <span class="sublabel">@(isMalayalam ? "‡¥â‡¥ü‡µª ‡¥∏‡¥π‡¥æ‡¥Ø‡¥Ç ‡¥≤‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï" : "Get immediate help")</span>
        </a>

        <!-- Daily Check-in -->
        <a href="@Url.Action("DailyCheckIn", "ElderCare")" class="elder-button btn-checkin" id="checkinBtn">
            <span class="notification-badge hidden" id="checkinBadge">!</span>
            <span class="icon">‚úÖ</span>
            <span class="label">@(isMalayalam ? "‡¥¶‡¥ø‡¥µ‡¥∏‡µá‡¥® ‡¥ö‡µÜ‡¥ï‡µç‡¥ï‡µç-‡¥á‡µª" : "Daily Check-in")</span>
            <span class="sublabel" id="checkinSublabel">@(isMalayalam ? "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∏‡µÅ‡¥ñ‡¥Ç ‡¥Ö‡¥±‡¥ø‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï" : "Let us know you're okay")</span>
        </a>

        <!-- Medicine Reminders -->
        <a href="@Url.Action("MedicineReminders", "ElderCare")" class="elder-button btn-medicine" id="medicineBtn">
            <span class="notification-badge hidden" id="medicineBadge">0</span>
            <span class="icon">üíä</span>
            <span class="label">@(isMalayalam ? "‡¥Æ‡¥∞‡µÅ‡¥®‡µç‡¥®‡µç ‡¥ì‡µº‡¥Æ‡µç‡¥Æ‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥≤‡µÅ‡¥ï‡µæ" : "Medicine Reminders")</span>
            <span class="sublabel">@(isMalayalam ? "‡¥Æ‡¥∞‡µÅ‡¥®‡µç‡¥®‡µç ‡¥ü‡µç‡¥∞‡¥æ‡¥ï‡µç‡¥ï‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï" : "Track your medications")</span>
        </a>

        <!-- Messages from Guardian -->
        <a href="@Url.Action("Messages", "ElderCare")" class="elder-button btn-messages" id="messagesBtn">
            <span class="notification-badge hidden" id="messagesBadge">0</span>
            <span class="icon">üí¨</span>
            <span class="label">@(isMalayalam ? "‡¥∏‡¥®‡µç‡¥¶‡µá‡¥∂‡¥ô‡µç‡¥ô‡µæ" : "Messages")</span>
            <span class="sublabel">@(isMalayalam ? "‡¥∞‡¥ï‡µç‡¥∑‡¥æ‡¥ß‡¥ø‡¥ï‡¥æ‡¥∞‡¥ø‡¥Ø‡µÅ‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥∏‡¥Ç‡¥∏‡¥æ‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï" : "Chat with guardian")</span>
        </a>

        <!-- Notes / Diary -->
        <a href="@Url.Action("Notes", "ElderCare")" class="elder-button btn-notes">
            <span class="icon">üìì</span>
            <span class="label">@(isMalayalam ? "‡¥ï‡µÅ‡¥±‡¥ø‡¥™‡µç‡¥™‡µÅ‡¥ï‡µæ / ‡¥°‡¥Ø‡¥±‡¥ø" : "Notes / Diary")</span>
            <span class="sublabel">@(isMalayalam ? "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ö‡¥ø‡¥®‡µç‡¥§‡¥ï‡µæ ‡¥é‡¥¥‡µÅ‡¥§‡µÅ‡¥ï" : "Write your thoughts")</span>
        </a>

        <!-- Wellness Tips -->
        <a href="@Url.Action("WellnessTips", "ElderCare")" class="elder-button btn-wellness">
            <span class="icon">üßò</span>
            <span class="label">@(isMalayalam ? "‡¥ï‡µç‡¥∑‡µá‡¥Æ ‡¥®‡µÅ‡¥±‡µÅ‡¥ô‡µç‡¥ô‡µÅ‡¥ï‡µæ" : "Wellness Tips")</span>
            <span class="sublabel">@(isMalayalam ? "‡¥Ü‡¥∞‡µã‡¥ó‡µç‡¥Ø‡¥ï‡¥∞‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥ú‡µÄ‡¥µ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï" : "Stay healthy & active")</span>
        </a>

        <!-- News -->
        <a href="@Url.Action("News", "ElderCare")" class="elder-button btn-news">
            <span class="icon">üì∞</span>
            <span class="label">@(isMalayalam ? "‡¥µ‡¥æ‡µº‡¥§‡µç‡¥§‡¥ï‡µæ" : "News")</span>
            <span class="sublabel">@(isMalayalam ? "‡¥è‡¥±‡µç‡¥±‡¥µ‡µÅ‡¥Ç ‡¥™‡µÅ‡¥§‡¥ø‡¥Ø ‡¥µ‡¥æ‡µº‡¥§‡µç‡¥§‡¥ï‡µæ" : "Latest headlines")</span>
        </a>

        <!-- Guardian Info -->
        <a href="@Url.Action("GuardianInfo", "ElderCare")" class="elder-button btn-guardian">
            <span class="icon">üë§</span>
            <span class="label">@(isMalayalam ? "‡¥∞‡¥ï‡µç‡¥∑‡¥æ‡¥ß‡¥ø‡¥ï‡¥æ‡¥∞‡¥ø ‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ" : "Guardian Info")</span>
            <span class="sublabel">@(isMalayalam ? "‡¥∞‡¥ï‡µç‡¥∑‡¥æ‡¥ß‡¥ø‡¥ï‡¥æ‡¥∞‡¥ø‡¥Ø‡µÜ ‡¥ï‡µÅ‡¥±‡¥ø‡¥ö‡µç‡¥ö‡µç" : "About your guardian")</span>
        </a>

        <!-- Edit Profile -->
        <a href="@Url.Action("EditProfile", "ElderCare")" class="elder-button btn-editprofile">
            <span class="icon">‚öôÔ∏è</span>
            <span class="label">@(isMalayalam ? "‡¥™‡µç‡¥∞‡µä‡¥´‡µà‡µΩ ‡¥é‡¥°‡¥ø‡¥±‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï" : "Edit Profile")</span>
            <span class="sublabel">@(isMalayalam ? "‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥Ö‡¥™‡µç‡¥°‡µá‡¥±‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï" : "Update your info")</span>
        </a>
    </div>

    <div class="text-center mt-4">
        <p class="text-muted" style="font-size: 1.1rem;">
            @(isMalayalam ? "‡¥é‡¥™‡µç‡¥™‡µã‡¥¥‡µÅ‡¥Ç ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥µ‡µá‡¥£‡µç‡¥ü‡¥ø ‡¥á‡¥µ‡¥ø‡¥ü‡µÜ‡¥Ø‡µÅ‡¥£‡µç‡¥ü‡µç" : "Always here for you") ‚ù§Ô∏è
        </p>
    </div>
</div>

@section Scripts {
    <script>
        // Malayalam text constants
        const notCheckedInText = '@Html.Raw(isMalayalam ? "‡¥á‡¥®‡µç‡¥®‡µç ‡¥ö‡µÜ‡¥ï‡µç‡¥ï‡µç-‡¥á‡µª ‡¥ö‡µÜ‡¥Ø‡µç‡¥§‡¥ø‡¥≤‡µç‡¥≤!" : "Not checked in today!")';
        const defaultCheckinText = '@Html.Raw(isMalayalam ? "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∏‡µÅ‡¥ñ‡¥Ç ‡¥Ö‡¥±‡¥ø‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï" : "Let us know you\u0027re okay")';
        
        // Load dashboard alerts
        document.addEventListener('DOMContentLoaded', function() {
            loadAlerts();
            // Refresh alerts every 30 seconds
            setInterval(loadAlerts, 30000);
        });
        
        function loadAlerts() {
            fetch('@Url.Action("GetElderDashboardAlerts", "ElderCare")')
                .then(r => r.json())
                .then(data => {
                    // Check-in alert
                    const checkinBadge = document.getElementById('checkinBadge');
                    const checkinSublabel = document.getElementById('checkinSublabel');
                    if (!data.checkedInToday) {
                        checkinBadge.classList.remove('hidden');
                        checkinSublabel.classList.add('alert-sublabel');
                        checkinSublabel.textContent = notCheckedInText;
                    } else {
                        checkinBadge.classList.add('hidden');
                        checkinSublabel.classList.remove('alert-sublabel');
                        checkinSublabel.textContent = defaultCheckinText;
                    }
                    
                    // Messages badge
                    const messagesBadge = document.getElementById('messagesBadge');
                    if (data.unreadMessages > 0) {
                        messagesBadge.textContent = data.unreadMessages;
                        messagesBadge.classList.remove('hidden');
                    } else {
                        messagesBadge.classList.add('hidden');
                    }
                    
                    // Medicine badge
                    const medicineBadge = document.getElementById('medicineBadge');
                    if (data.reminderCount > 0) {
                        medicineBadge.textContent = data.reminderCount;
                        medicineBadge.classList.remove('hidden');
                    } else {
                        medicineBadge.classList.add('hidden');
                    }
                });
        }
        
        // Auto-refresh time display
        function updateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            // Could add a time display element if needed
        }
        updateTime();
        setInterval(updateTime, 60000);
    </script>
}
