@{
    ViewData["Title"] = "ServConnect - Your Service Marketplace";
    var newsLocations = ViewBag.NewsLocations as string[] ?? new[] { "Kattappana", "Nedumkandam", "Kanjirappally", "Kumily", "Kuttikkanam" };
    var defaultNewsLocation = newsLocations.Length > 0 ? newsLocations[0] : "Kattappana";
}

<style>
    body, html {
        margin: 0;
        padding: 0;
    }
    
    .hero-section {
        position: relative;
        color: white;
        padding: 0;
        text-align: left;
        margin: 0;
        background: url('@Url.Content("~/images/hero-bg.png")') center/cover no-repeat;
        min-height: 100vh;
        display: flex;
        align-items: center;
        overflow: hidden;
        width: 100vw;
        margin-left: calc(-50vw + 50%);
        margin-right: calc(-50vw + 50%);
    }
    .hero-section:before{
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0.1) 100%);
    }
    .hero-section > .container{ 
        position: relative; 
        z-index: 1; 
        margin: 0 auto;
        padding: 0 15px;
    }
    
    .hero-section h1 {
        font-size: 4rem;
        font-weight: 700;
        letter-spacing: -0.02em;
        margin-bottom: 24px;
        line-height: 1.1;
    }
    
    .hero-section p {
        font-size: 1.25rem;
        margin-bottom: 40px;
        opacity: 1;
        font-weight: 400;
        line-height: 1.6;
    }
    
    .search-container {
        max-width: 100%;
        margin: 0;
        position: relative;
    }
    
    .search-wrap {
        background: #fff;
        border-radius: 16px;
        padding: 12px;
        display: grid;
        grid-template-columns: 180px 1fr 60px;
        gap: 12px;
        box-shadow: 0 20px 50px rgba(0,0,0,.15);
        align-items: center;
        max-width: 600px;
    }
    .search-select{ 
        border: 1px solid #e5e7eb; 
        border-radius: 12px; 
        padding: 16px 20px; 
        font-weight: 500; 
        font-size: 1rem;
        background: #fff;
    }
    .search-input {
        width: 100%;
        padding: 16px 20px;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        font-size: 1rem;
        background: #fff;
    }
    
    .search-btn {
        background: #10B981;
        border: none;
        border-radius: 12px;
        padding: 16px 20px;
        color: white;
        font-weight: 600;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .search-btn:hover { 
        background: #059669; 
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
    }

    .highlight-badge { 
        background: #10B981; 
        color: #fff; 
        padding: 8px 16px; 
        border-radius: 8px; 
        font-weight: 600; 
        display: inline-block;
        margin-left: 8px;
    }

    .category-chips { 
        display:flex; 
        gap:12px; 
        flex-wrap:wrap; 
        justify-content:flex-start; 
        margin-top:32px; 
    }
    .category-chip { 
        background: rgba(255,255,255,0.1); 
        color: #fff; 
        border: 1px solid rgba(255,255,255,0.2); 
        padding: 12px 20px; 
        border-radius: 50px; 
        font-size: 0.95rem; 
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }
    .category-chip:hover{ 
        background: rgba(255,255,255,0.2); 
        color: #fff; 
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    /* Hero advertisement container */
    .hero-ad-container {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        margin-top: 0;
    }
    
    .hero-ad-container-top {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        margin-top: 0;
        margin-bottom: 1.5rem;
        width: 100%;
    }

    /* Action buttons styling */
    .action-buttons {
        margin-top: 24px;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
        width: 100%;
        max-width: 500px;
    }
    .action-btn {
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 16px;
        padding: 24px 20px;
        text-decoration: none;
        color: #1f2937;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 12px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    .action-btn:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        color: #1f2937;
        text-decoration: none;
    }
    .action-btn i {
        font-size: 1.25rem;
        color: #10B981;
    }
    .top-news-trigger {
        grid-column: span 2;
    }

    /* Staggered reveal for cards */
    .section-stagger .stagger-item { opacity: 0; transform: translateY(14px); }
    .section-stagger.revealed .stagger-item { animation: sc-fade-up .6s ease forwards; }
    .section-stagger.revealed .stagger-item:nth-child(1) { animation-delay: .05s; }
    .section-stagger.revealed .stagger-item:nth-child(2) { animation-delay: .15s; }
    .section-stagger.revealed .stagger-item:nth-child(3) { animation-delay: .25s; }
    .section-stagger.revealed .stagger-item:nth-child(4) { animation-delay: .35s; }
    
    .features-section {
        padding: 80px 0;
        background: #f8fafc;
    }
    
    .feature-card {
        background: #fff;
        padding: 48px 32px;
        border-radius: 20px;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
        margin-bottom: 30px;
        height: 100%;
        border: 1px solid #f1f5f9;
    }
    
    .feature-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 25px 50px rgba(0,0,0,0.1);
        border-color: #e2e8f0;
    }
    
    .feature-icon {
        width: 72px;
        height: 72px;
        background: linear-gradient(135deg, #10B981 0%, #059669 100%);
        border-radius: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 24px;
        font-size: 1.75rem;
        color: white;
        box-shadow: 0 8px 25px rgba(16, 185, 129, 0.2);
    }
    
    .feature-card h3 {
        color: #1f2937;
        margin-bottom: 16px;
        font-size: 1.5rem;
        font-weight: 600;
    }
    
    .feature-card p {
        color: #6b7280;
        line-height: 1.6;
        font-size: 1rem;
    }
    
    .services-section {
        padding: 80px 0;
        background: #fff;
    }
    
    .section-title {
        text-align: center;
        margin-bottom: 50px;
    }
    
    .section-title h2 {
        font-size: 2.75rem;
        color: #1f2937;
        margin-bottom: 16px;
        font-weight: 700;
    }
    
    .section-title p {
        font-size: 1.25rem;
        color: #6b7280;
        font-weight: 400;
    }
    
    .service-category {
        background: #fff;
        border-radius: 20px;
        padding: 40px 32px;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
        margin-bottom: 30px;
        cursor: pointer;
        border: 1px solid #f1f5f9;
    }
    
    .service-category:hover {
        transform: translateY(-8px);
        box-shadow: 0 25px 50px rgba(0,0,0,0.1);
        border-color: #e2e8f0;
    }
    
    .service-category.home-services {
        border-top: 4px solid #10B981;
    }
    
    .service-category.tech-services {
        border-top: 4px solid #3B82F6;
    }
    
    .service-category.beauty-services {
        border-top: 4px solid #EC4899;
    }
    
    .service-category.business-services {
        border-top: 4px solid #F59E0B;
    }
    
    .service-icon {
        font-size: 3rem;
        margin-bottom: 20px;
    }
    
    .service-category.home-services .service-icon {
        color: #10B981;
    }
    
    .service-category.tech-services .service-icon {
        color: #3B82F6;
    }
    
    .service-category.beauty-services .service-icon {
        color: #EC4899;
    }
    
    .service-category.business-services .service-icon {
        color: #F59E0B;
    }
    
    /* Ensure links in service categories don't have default styling */
    .service-category a,
    a .service-category {
        color: inherit;
        text-decoration: none;
    }
    
    .service-category a:hover,
    a:hover .service-category {
        color: inherit;
        text-decoration: none;
    }
    
    .service-category h4 {
        color: #1f2937;
        margin-bottom: 12px;
        font-size: 1.375rem;
        font-weight: 600;
    }
    
    .service-category p {
        color: #6b7280;
        margin-bottom: 20px;
        font-size: 1rem;
    }
    
    .service-count {
        background: #f1f5f9;
        padding: 8px 16px;
        border-radius: 50px;
        font-size: 0.875rem;
        color: #64748b;
        display: inline-block;
        font-weight: 500;
    }
    
    .cta-section {
        background: linear-gradient(135deg, #063e1cdb 0%, #165830db 100%);
        color: white;
        padding: 80px 0;
        text-align: center;
    }
    
    .cta-section h2 {
        font-size: 2.75rem;
        margin-bottom: 20px;
        font-weight: 700;
    }
    
    .cta-section p {
        font-size: 1.25rem;
        margin-bottom: 40px;
        opacity: 0.9;
        font-weight: 400;
    }
    
    .cta-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .cta-btn {
        padding: 16px 32px;
        border: 2px solid #10B981;
        border-radius: 12px;
        color: #10B981;
        background: transparent;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 12px;
        font-size: 1rem;
    }
    
    .cta-btn:hover {
        background: #10B981;
        color: white;
        text-decoration: none;
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
    }
    
    .stats-section {
        padding: 80px 0;
        background: #f8fafc;
    }
    
    .stat-item {
        text-align: center;
        margin-bottom: 30px;
    }
    
    .stat-number {
        font-size: 3.5rem;
        font-weight: 700;
        color: #10B981;
        margin-bottom: 12px;
    }
    
    .stat-label {
        color: #6b7280;
        font-size: 1.125rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 500;
    }
    
    @@media (max-width: 768px) {
        .hero-section h1 {
            font-size: 2.5rem;
        }
        
        .hero-section p {
            font-size: 1.1rem;
        }
        
        .hero-ad-container,
        .hero-ad-container-top {
            margin-bottom: 20px;
        }
        
        .action-buttons {
            margin-top: 20px;
            grid-template-columns: 1fr;
        }
    }
    
    @@media (max-width: 991px) {
        .hero-ad-container,
        .hero-ad-container-top {
            margin-bottom: 30px;
        }
    }
    
    @@media (max-width: 576px) {
        .search-wrap {
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        .search-select, .search-input, .search-btn {
            padding: 14px 16px;
        }
        
        .cta-buttons {
            flex-direction: column;
            align-items: center;
        }
        
        .section-title h2 {
            font-size: 2rem;
        }
    }
</style>

<!-- Hero Section -->
<div class="hero-section">
    <div class="container">
        <div class="row min-vh-100">
            <div class="col-lg-6 d-flex flex-column justify-content-center">
                <p class="mb-3 text-white-50">Order any service, anytime from anywhere</p>
                <h1 class="text-white mb-4">Find the Perfect <span class="highlight-badge">Service</span> for Your Needs</h1>
                <p class="text-white-50 mb-5">Connect with trusted service providers and vendors in your area. Get quality services delivered right to your doorstep.</p>

                <div class="search-container">
                    <div class="search-wrap">
                        <select class="form-select search-select" id="searchLocation">
                            @for (var i = 0; i < newsLocations.Length; i++)
                            {
                                var place = newsLocations[i];
                                if (i == 0)
                                {
                                    <option value="@place" selected>@place</option>
                                }
                                else
                                {
                                    <option value="@place">@place</option>
                                }
                            }
                        </select>
                        <input class="search-input" id="searchInput" placeholder="What are you looking for?" />
                        <button class="search-btn" id="searchBtn"><i class="bi bi-search"></i></button>
                        
                        <style>
                            .hero-results { margin-top:16px; }
                            .service-card { border:1px solid #e5e7eb; border-radius:12px; padding:12px 16px; background:#fff; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center; }
                            .service-title { font-weight:600; }
                            .service-meta { font-size:.9rem; color:#6b7280; }
                        </style>
                    </div>
                </div>
                <style>
                    .osm-quick-cards { margin-top: 14px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
                    .osm-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 10px 12px; cursor: pointer; display:flex; align-items:center; gap:8px; transition: transform .1s ease, box-shadow .1s ease; }
                    .osm-card:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,.08); }
                    .osm-card i { color:#0ea5e9; }
                    @@media (max-width: 768px){ .osm-quick-cards{ grid-template-columns: repeat(2, 1fr);} }
                </style>
                <!-- Moved OSM quick cards into LocalDirectory/Discover search; removing from hero -->
                <div class="osm-quick-cards d-none"></div>

                <div class="category-chips">
                    @if (User.Identity?.IsAuthenticated ?? false)
                    {
                        <a href="/Services/Browse?q=Plumber" class="category-chip">@Localizer["Category.Plumber"]</a>
                        <a href="/Services/Browse?q=Electrician" class="category-chip">@Localizer["Category.Electrician"]</a>
                        <a href="/Services/Browse?q=Cleaner" class="category-chip">@Localizer["Category.Cleaner"]</a>
                        <a href="/Services/Browse?q=Painting" class="category-chip">@Localizer["Category.Painting"]</a>
                        <a href="/Services/Browse?q=Salon" class="category-chip">@Localizer["Category.Salon"]</a>
                        <a href="/Services/Browse" class="category-chip">@Localizer["Category.More"]</a>
                    }
                    else
                    {
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Services/Browse?q=Plumber" class="category-chip">@Localizer["Category.Plumber"]</a>
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Services/Browse?q=Electrician" class="category-chip">@Localizer["Category.Electrician"]</a>
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Services/Browse?q=Cleaner" class="category-chip">@Localizer["Category.Cleaner"]</a>
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Services/Browse?q=Painting" class="category-chip">@Localizer["Category.Painting"]</a>
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Services/Browse?q=Salon" class="category-chip">@Localizer["Category.Salon"]</a>
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Services/Browse" class="category-chip">@Localizer["Category.More"]</a>
                    }
                </div>
            </div>
            <div class="col-lg-6 d-flex flex-column justify-content-start align-items-center">
                <!-- Hero Advertisement Banner -->
                <div class="hero-ad-container-top mb-4">
                    @await Component.InvokeAsync("HeroAdvertisement")
                </div>
                
                <!-- Spacer to push action buttons to center -->
                <div class="flex-grow-1 d-flex align-items-center">
                    <div class="action-buttons">
                        <a href="/Home/News" class="action-btn top-news-trigger">
                            <i class="fas fa-newspaper"></i>
                            <div>
                                <div class="fw-bold">Top News</div>
                                <small>Stay updated with your city</small>
                            </div>
                        </a>
                    @if (User.Identity?.IsAuthenticated ?? false)
                    {
                        <a href="/Services/Browse" class="action-btn">
                            <i class="fas fa-calendar-check"></i>
                            <div>
                                <div class="fw-bold">@Localizer["CTA.BookService.Title"]</div>
                                <small class="text-muted">@Localizer["CTA.BookService.Desc"]</small>
                            </div>
                        </a>
                        <a href="/LocalDirectory/Discover" class="action-btn">
                            <i class="fas fa-search-location"></i>
                            <div>
                                <div class="fw-bold">@Localizer["CTA.SearchLocal.Title"]</div>
                                <small class="text-muted">@Localizer["CTA.SearchLocal.Desc"]</small>
                            </div>
                        </a>
                    }
                    else
                    {
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Services/Browse" class="action-btn">
                            <i class="fas fa-calendar-check"></i>
                            <div>
                                <div class="fw-bold">@Localizer["CTA.BookService.Title"]</div>
                                <small class="text-muted">@Localizer["CTA.BookService.Desc"]</small>
                            </div>
                        </a>
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/LocalDirectory/Discover" class="action-btn">
                            <i class="fas fa-search-location"></i>
                            <div>
                                <div class="fw-bold">@Localizer["CTA.SearchLocal.Title"]</div>
                                <small class="text-muted">@Localizer["CTA.SearchLocal.Desc"]</small>
                            </div>
                        </a>
                    }
                    @if (User.Identity?.IsAuthenticated ?? false)
                    {
                        <a href="/Home/Items?role=Vendor" class="action-btn">
                            <i class="fas fa-store"></i>
                            <div>
                                <div class="fw-bold">@Localizer["CTA.VendorItems.Title"]</div>
                                <small class="text-muted">@Localizer["CTA.VendorItems.Desc"]</small>
                            </div>
                        </a>
                    }
                    else
                    {
                        <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Home/Items?role=Vendor" class="action-btn">
                            <i class="fas fa-store"></i>
                            <div>
                                <div class="fw-bold">@Localizer["CTA.VendorItems.Title"]</div>
                                <small class="text-muted">@Localizer["CTA.VendorItems.Desc"]</small>
                            </div>
                        </a>
                    }
                    <a href="#" class="action-btn" onclick="alert('@Localizer["Msg.NoResults"]');return false;">
                        <i class="fas fa-sync-alt"></i>
                        <div>
                            <div class="fw-bold">@Localizer["CTA.DailyEssentials.Title"]</div>
                            <small class="text-muted">@Localizer["CTA.DailyEssentials.Desc"]</small>
                        </div>
                    </a>
                </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Hero search: fetch from local directory API with location
    async function runHeroSearch(){
        const loc = document.getElementById('searchLocation').value;
        const q = (document.getElementById('searchInput').value || '').trim();
        const url = new URL(location.origin + '/api/local/services');
        if(q) url.searchParams.set('q', q);
        url.searchParams.set('locationName', loc);
        try{
            const res = await fetch(url);
            const list = await res.json();
            const containerId = 'heroResults';
            let container = document.getElementById(containerId);
            if(!container){
                container = document.createElement('div');
                container.id = containerId;
                container.className = 'hero-results';
                document.querySelector('.search-container').appendChild(container);
            }
            if(!Array.isArray(list) || list.length === 0){
                container.innerHTML = '<div class="text-white-50 mt-3">No results found.</div>';
                return;
            }
            list.sort((a,b)=> (b.rating||0)-(a.rating||0));
            container.innerHTML = list.map(s => {
                const stars = (s.rating||0) > 0 ? `<span class="badge bg-warning text-dark ms-2"><i class="fas fa-star"></i> ${Number(s.rating).toFixed(1)}${s.ratingCount?` (${s.ratingCount})`:''}</span>` : '';
                const addr = s.address ? `<div class="service-meta">${s.address}</div>` : '';
                const mapHref = s.mapUrl ? s.mapUrl : `/local/services/${s.id}/map`;
                const rate = `<div class="mt-2">
                    <span class="me-2">Rate:</span>
                    ${[1,2,3,4,5].map(n=>`<button class='btn btn-sm ${n<=Math.round(s.rating)?'btn-warning':'btn-outline-secondary'} me-1' onclick='rateService(${JSON.stringify(s.id)}, ${n})'>${n}</button>`).join('')}
                </div>`;
                return `<div class="service-card">
                    <div>
                        <div class="service-title">${s.name} ${stars}</div>
                        <div class="service-meta">${s.categoryName||''}</div>
                        ${addr}
                        ${rate}
                    </div>
                    <a class="btn btn-sm btn-outline-success" target="_blank" href="${mapHref}"><i class="fas fa-map-marker-alt"></i> Map</a>
                </div>`;
            }).join('');
        }catch{
            alert('Failed to load results');
        }
    }
    async function rateService(id, rating){
        try{
            const res = await fetch(`/api/local/services/${id}/rating`, {
                method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({rating})
            });
            if(res.ok){
                runHeroSearch();
            }else if(res.status === 401){
                alert('Please login to rate');
            }else{
                alert('Failed to submit rating');
            }
        }catch{
            alert('Failed to submit rating');
        }
    }
    function quickSearch(name){
        const input = document.getElementById('searchInput');
        input.value = name;
        runHeroSearch();
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('searchBtn').addEventListener('click', (e)=>{ e.preventDefault(); runHeroSearch(); });
        document.getElementById('searchInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); runHeroSearch(); }});
    });
</script>

<!-- Features Section -->
<div class="features-section reveal section-stagger">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-4 stagger-item">
                <div class="feature-card card-hover">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Trusted Providers</h3>
                    <p>All service providers are verified and rated by real customers to ensure quality and reliability.</p>
                </div>
            </div>
            
            <div class="col-md-4 stagger-item">
                <div class="feature-card card-hover">
                    <div class="feature-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h3>Quick Booking</h3>
                    <p>Book services instantly with our easy-to-use platform. Get confirmed appointments in minutes.</p>
                </div>
            </div>
            
            <div class="col-md-4 stagger-item">
                <div class="feature-card card-hover">
                    <div class="feature-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <h3>Best Prices</h3>
                    <p>Compare prices from multiple providers and choose the best deal that fits your budget.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Services Section -->
<div class="services-section reveal section-stagger">
    <div class="container-fluid">
        <div class="section-title">
            <h2>What You Can Do on ServConnect</h2>
            <p>Explore our comprehensive platform features</p>
        </div>
        
        <div class="row">
            <div class="col-md-6 col-lg-3 stagger-item">
                @if (User.Identity?.IsAuthenticated ?? false)
                {
                    <a href="/Services/Browse" class="text-decoration-none">
                        <div class="service-category home-services card-hover">
                            <div class="service-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <h4>Service Booking</h4>
                            <p>Find and book trusted service providers</p>
                            <span class="service-count">Quick & Easy</span>
                        </div>
                    </a>
                }
                else
                {
                    <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Services/Browse" class="text-decoration-none">
                        <div class="service-category home-services card-hover">
                            <div class="service-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <h4>Service Booking</h4>
                            <p>Find and book trusted service providers</p>
                            <span class="service-count">Quick & Easy</span>
                        </div>
                    </a>
                }
            </div>
            
            <div class="col-md-6 col-lg-3 stagger-item">
                @if (User.Identity?.IsAuthenticated ?? false)
                {
                    <a href="/LocalDirectory/Discover" class="text-decoration-none">
                        <div class="service-category tech-services card-hover">
                            <div class="service-icon">
                                <i class="fas fa-search-location"></i>
                            </div>
                            <h4>Discover Local Service</h4>
                            <p>Find local businesses and services near you</p>
                            <span class="service-count">Location-Based</span>
                        </div>
                    </a>
                }
                else
                {
                    <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/LocalDirectory/Discover" class="text-decoration-none">
                        <div class="service-category tech-services card-hover">
                            <div class="service-icon">
                                <i class="fas fa-search-location"></i>
                            </div>
                            <h4>Discover Local Service</h4>
                            <p>Find local businesses and services near you</p>
                            <span class="service-count">Location-Based</span>
                        </div>
                    </a>
                }
            </div>
            
            <div class="col-md-6 col-lg-3 stagger-item">
                @if (User.Identity?.IsAuthenticated ?? false)
                {
                    <a href="/Home/Items" class="text-decoration-none">
                        <div class="service-category beauty-services card-hover">
                            <div class="service-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <h4>Shop Items</h4>
                            <p>Browse and purchase items from vendors</p>
                            <span class="service-count">Marketplace</span>
                        </div>
                    </a>
                }
                else
                {
                    <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Home/Items" class="text-decoration-none">
                        <div class="service-category beauty-services card-hover">
                            <div class="service-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <h4>Shop Items</h4>
                            <p>Browse and purchase items from vendors</p>
                            <span class="service-count">Marketplace</span>
                        </div>
                    </a>
                }
            </div>
            
            <div class="col-md-6 col-lg-3 stagger-item">
                <div class="service-category business-services card-hover" onclick="alert('Daily essentials subscription feature coming soon!')">
                    <div class="service-icon">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <h4>Daily Essential Subscriptions</h4>
                    <p>Subscribe to daily essentials delivery</p>
                    <span class="service-count">Coming Soon</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Stats Section -->
<div class="stats-section reveal">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3 col-sm-6">
                <div class="stat-item">
                    <div class="stat-number">@(ViewBag.TotalUsers > 0 ? ViewBag.TotalUsers.ToString("N0") + "+" : "0")</div>
                    <div class="stat-label">Happy Customers</div>
                </div>
            </div>
            
            <div class="col-md-3 col-sm-6">
                <div class="stat-item">
                    <div class="stat-number">@(ViewBag.ServiceProviders > 0 ? ViewBag.ServiceProviders.ToString() + "+" : "0")</div>
                    <div class="stat-label">Service Providers</div>
                </div>
            </div>
            
            <div class="col-md-3 col-sm-6">
                <div class="stat-item">
                    <div class="stat-number">@(ViewBag.CompletedServices > 0 ? ViewBag.CompletedServices.ToString("N0") + "+" : "0")</div>
                    <div class="stat-label">Services Completed</div>
                </div>
            </div>
            
            <div class="col-md-3 col-sm-6">
                <div class="stat-item">
                    <div class="stat-number">@ViewBag.AverageRating</div>
                    <div class="stat-label">Average Rating</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- CTA Section -->
<div class="cta-section">
    <div class="container-fluid">
        <h2>Ready to Get Started?</h2>
        <p>Join thousands of satisfied customers and service providers</p>
        
        <div class="cta-buttons">
            @if (User.Identity.IsAuthenticated)
            {
                <a href="/Advertisements/Submit" class="cta-btn">
                    <i class="fas fa-bullhorn"></i>
                    Publish Advertisement
                </a>
                <a href="/Advertisements/My" class="cta-btn">
                    <i class="fas fa-rectangle-list"></i>
                    My Advertisements
                </a>
                <a href="/Account/Profile" class="cta-btn">
                    <i class="fas fa-user"></i>
                    My Account
                </a>
                <a href="/Complaints/Create?role=User" class="cta-btn">
                    <i class="fas fa-flag"></i>
                    Raise Complaint
                </a>
            }
            else
            {
                <!-- Unauthenticated: gate complaint link to login -->
                <a href="/Account/Register" class="cta-btn">
                    <i class="fas fa-user-plus"></i>
                    Sign Up Now
                </a>
                <a href="/Account/Login" class="cta-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    Login
                </a>
                <a asp-controller="Account" asp-action="Login" asp-route-returnUrl="/Complaints/Create?role=User" class="cta-btn">
                    <i class="fas fa-flag"></i>
                    Raise Complaint
                </a>
            }
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Animate stats on scroll
        const observerOptions = {
            threshold: 0.5,
            rootMargin: '0px 0px -100px 0px'
        };
        
        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const statNumbers = entry.target.querySelectorAll('.stat-number');
                    statNumbers.forEach(stat => {
                        const text = stat.textContent;
                        const hasPlus = text.includes('+');
                        const isDecimal = text.includes('.');
                        
                        if (isDecimal) {
                            // Handle decimal numbers like 4.8
                            const finalNumber = parseFloat(text);
                            let currentNumber = 0;
                            const increment = finalNumber / 30;
                            
                            const timer = setInterval(() => {
                                currentNumber += increment;
                                if (currentNumber >= finalNumber) {
                                    stat.textContent = finalNumber.toFixed(1);
                                    clearInterval(timer);
                                } else {
                                    stat.textContent = currentNumber.toFixed(1);
                                }
                            }, 50);
                        } else {
                            // Handle regular numbers
                            const finalNumber = parseInt(text.replace(/[^0-9]/g, ''));
                            let currentNumber = 0;
                            const increment = finalNumber / 50;
                            
                            const timer = setInterval(() => {
                                currentNumber += increment;
                                if (currentNumber >= finalNumber) {
                                    stat.textContent = finalNumber.toLocaleString() + (hasPlus ? '+' : '');
                                    clearInterval(timer);
                                } else {
                                    stat.textContent = Math.floor(currentNumber).toLocaleString() + (hasPlus ? '+' : '');
                                }
                            }, 30);
                        }
                    });
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);
        
        const revealSections = document.querySelectorAll('.reveal');
        revealSections.forEach(sec => {
            const obs = new IntersectionObserver((entries) => {
                entries.forEach(e => {
                    if (e.isIntersecting) {
                        e.target.classList.add('revealed');
                        obs.unobserve(e.target);
                    }
                });
            }, {threshold: 0.15});
            obs.observe(sec);
        });
        
        // Search functionality - route to Browse like the reference, but require login if unauthenticated
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        
        searchBtn.addEventListener('click', function() {
            const query = searchInput.value.trim();
            if (!query) return;
            sessionStorage.setItem('browse_q', query);
            const isAuthed = document.body.getAttribute('data-authed') === 'true';
            if (isAuthed) {
                window.location.href = '/Services/Browse';
            } else {
                // redirect to login, then back to browse
                window.location.href = '/Account/Login?returnUrl=' + encodeURIComponent('/Services/Browse');
            }
        });
        
        searchInput?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchBtn.click();
            }
        });
    });
</script>