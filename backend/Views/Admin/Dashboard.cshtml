@{
    ViewData["Title"] = "Admin Dashboard";
}

<style>
    .dashboard-container { padding: 20px; background-color: var(--bg-page); min-height: 100vh; }
    .dashboard-header { background: var(--header-bg) !important; color: #fff; padding: 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: var(--shadow-md); }
    .dashboard-header h1 { margin: 0; font-size: 2.2rem; font-weight: 600; }
    .dashboard-header p { margin: 10px 0 0 0; opacity: 0.9; font-size: 1.05rem; }

    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }

    .stat-card { background: var(--bg-surface); padding: 25px; border-radius: 15px; box-shadow: var(--shadow-sm); transition: transform 0.2s ease, box-shadow 0.2s ease; border-left: 4px solid var(--border); }
    .stat-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-md); }

    .stat-number { font-size: 2.2rem; font-weight: 700; margin: 0; color: var(--text-primary); }
    .stat-label { color: var(--text-secondary); font-size: 0.95rem; margin-top: 6px; text-transform: uppercase; letter-spacing: 0.4px; }
    .stat-icon { float: right; font-size: 2rem; opacity: 0.3; margin-top: -10px; color: #9CA3AF; }

    .action-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }

    .action-card { background: var(--bg-surface); border-radius: 15px; overflow: hidden; box-shadow: var(--shadow-sm); transition: transform 0.2s ease, box-shadow 0.2s ease; border:1px solid var(--border); }
    .action-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-md); }

    .action-header { padding: 16px 20px; background: #111; color: #fff; }
    .action-header h3 { margin: 0; font-size: 1.15rem; }

    .action-body { padding: 18px 20px; }
    .action-list { list-style: none; padding: 0; margin: 0; }
    .action-list li { padding: 10px 0; border-bottom: 1px solid var(--border); }
    .action-list li:last-child { border-bottom: none; }
    .action-list a { color: var(--text-primary); text-decoration: none; display: flex; align-items: center; gap:10px; transition: color 0.2s ease; }
    .action-list a:hover { color: var(--accent-indigo); }
    .action-list i { width: 20px; color: var(--accent-indigo); }

    .recent-activity { background: var(--bg-surface); border-radius: 15px; padding: 25px; box-shadow: var(--shadow-sm); border:1px solid var(--border); }
    .recent-activity h3 { margin: 0 0 20px 0; color: var(--text-primary); font-size: 1.4rem; }

    @@media (max-width: 768px) {
        .dashboard-container { padding: 10px; }
        .dashboard-header { padding: 20px; }
        .dashboard-header h1 { font-size: 1.8rem; }
        .stats-grid { grid-template-columns: 1fr; }
        .action-grid { grid-template-columns: 1fr; }
    }

    /* Footer CTA */
    .dashboard-footer { margin-top: 30px; padding: 18px 22px; border-radius: 12px; background: var(--header-bg); color: #fff; display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; box-shadow: var(--shadow-md); }
    .dashboard-footer .cta { display:flex; gap:10px; }
    .dashboard-footer .btn-outline-light { border-color:#fff; color:#fff; }
    .dashboard-footer .btn-outline-light:hover { background:#fff; color:#111; }
</style>

<div class="dashboard-container">
    <!-- Header -->
    <div class="dashboard-header">
        <h1><i class="fas fa-crown"></i> Admin Dashboard</h1>
        <p>Welcome back, @ViewBag.AdminName! Here's what's happening with ServConnect today.</p>
    </div>

    <!-- Quick Tiles -->
    <div class="container-narrow mb-4">
        <div class="tile-grid">
            <a class="tile" asp-controller="Admin" asp-action="Users">
                <div class="tile-icon"><i class="fas fa-users"></i></div>
                <div>
                    <div class="tile-title">Manage Users</div>
                    <div class="tile-sub">View, roles, actions</div>
                </div>
            </a>
            <a class="tile" asp-controller="Admin" asp-action="CreateAd">
                <div class="tile-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                <div>
                    <div class="tile-title">Upload Ad</div>
                    <div class="tile-sub">Add new banner</div>
                </div>
            </a>
            <a class="tile" asp-controller="Admin" asp-action="Advertisements">
                <div class="tile-icon"><i class="fas fa-images"></i></div>
                <div>
                    <div class="tile-title">Advertisements</div>
                    <div class="tile-sub">Review and delete</div>
                </div>
            </a>
            <a class="tile" asp-controller="LocalDirectory" asp-action="Manage">
                <div class="tile-icon"><i class="fas fa-map-marked-alt"></i></div>
                <div>
                    <div class="tile-title">Local Services</div>
                    <div class="tile-sub">Hospitals, police, fuel</div>
                </div>
            </a>
            <a class="tile" asp-controller="Services" asp-action="Manage">
                <div class="tile-icon"><i class="fas fa-clipboard-list"></i></div>
                <div>
                    <div class="tile-title">Service Catalog</div>
                    <div class="tile-sub">Create and manage</div>
                </div>
            </a>
            <a class="tile" asp-controller="Admin" asp-action="Settings">
                <div class="tile-icon"><i class="fas fa-gear"></i></div>
                <div>
                    <div class="tile-title">Settings</div>
                    <div class="tile-sub">System preferences</div>
                </div>
            </a>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="stats-grid">
        <div class="stat-card users">
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
            <h2 class="stat-number">@ViewBag.TotalUsers</h2>
            <p class="stat-label">Total Users</p>
        </div>
        
        <div class="stat-card providers">
            <div class="stat-icon">
                <i class="fas fa-tools"></i>
            </div>
            <h2 class="stat-number">@ViewBag.ServiceProviders</h2>
            <p class="stat-label">Service Providers</p>
        </div>
        
        <div class="stat-card vendors">
            <div class="stat-icon">
                <i class="fas fa-store"></i>
            </div>
            <h2 class="stat-number">@ViewBag.Vendors</h2>
            <p class="stat-label">Vendors</p>
        </div>
        
        <div class="stat-card services">
            <div class="stat-icon">
                <i class="fas fa-concierge-bell"></i>
            </div>
            <h2 class="stat-number">@ViewBag.RegularUsers</h2>
            <p class="stat-label">Regular Users</p>
        </div>
        
        <div class="stat-card complaints">
            <div class="stat-icon">
                <i class="fas fa-envelope-open-text"></i>
            </div>
            <h2 class="stat-number">@ViewBag.NewComplaints</h2>
            <p class="stat-label">New Complaints</p>
        </div>
    </div>

    <!-- Action Cards -->
    <div class="action-grid">
        <div class="action-card">
            <div class="action-header">
                <h3><i class="fas fa-users-cog"></i> User Management</h3>
            </div>
            <div class="action-body">
                <ul class="action-list">
                    <li><a href="#"><i class="fas fa-user-plus"></i> Add New User</a></li>
                    <li><a asp-controller="Admin" asp-action="Users"><i class="fas fa-users"></i> View All Users</a></li>
                    <li><a href="#"><i class="fas fa-user-shield"></i> Manage Roles</a></li>
                    <li><a asp-controller="Admin" asp-action="Users" asp-route-suspended="true"><i class="fas fa-ban"></i> Suspended Users</a></li>
                </ul>
            </div>
        </div>

        <div class="action-card">
            <div class="action-header">
                <h3><i class="fas fa-cogs"></i> System Management</h3>
            </div>
            <div class="action-body">
                <ul class="action-list">
                    <li><a href="#"><i class="fas fa-chart-bar"></i> Analytics</a></li>
                    <li><a href="#"><i class="fas fa-database"></i> Database Status</a></li>
                    <li><a href="#"><i class="fas fa-shield-alt"></i> Security Logs</a></li>
                    <li><a href="#"><i class="fas fa-cog"></i> System Settings</a></li>
                </ul>
            </div>
        </div>

        <div class="action-card">
            <div class="action-header">
                <h3><i class="fas fa-handshake"></i> Service Management</h3>
            </div>
            <div class="action-body">
                <ul class="action-list">
                    <li><a href="#"><i class="fas fa-list"></i> All Services</a></li>
                    <li><a href="#"><i class="fas fa-clock"></i> Pending Approvals</a></li>
                    <li><a href="#"><i class="fas fa-star"></i> Featured Services</a></li>
                    <li><a href="#"><i class="fas fa-flag"></i> Reported Services</a></li>
                </ul>
            </div>
        </div>

        <div class="action-card">
            <div class="action-header">
                <h3><i class="fas fa-chart-line"></i> Reports & Analytics</h3>
            </div>
            <div class="action-body">
                <ul class="action-list">
                    <li><a href="#"><i class="fas fa-chart-pie"></i> Usage Statistics</a></li>
                    <li><a href="#"><i class="fas fa-dollar-sign"></i> Revenue Reports</a></li>
                    <li><a href="#"><i class="fas fa-download"></i> Export Data</a></li>
                    <li><a href="#"><i class="fas fa-calendar"></i> Monthly Reports</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Recent Complaints / Messages -->
    <div class="recent-activity">
        <h3><i class="fas fa-inbox"></i> Messages / Complaints</h3>
        <div id="complaintsContainer">Loading...</div>
        <div class="mt-3">
            <a class="btn btn-outline-primary btn-sm" href="/Admin/Complaints">View All</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async function(){
            const container = document.getElementById('complaintsContainer');
            try {
                const res = await fetch('/api/complaints?limit=6');
                if(!res.ok){ container.textContent = 'Failed to load.'; return; }
                const list = await res.json();
                if(!list.length){ container.textContent = 'No messages yet.'; return; }
                container.innerHTML = '';
                list.forEach(c => {
                    const card = document.createElement('div');
                    card.className = 'card mb-2';
                    card.innerHTML = `
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <strong>${c.category}</strong> - ${c.complainantName} (${c.complainantRole})
                                    <div class="text-muted small">${new Date(c.createdAt).toLocaleString()}</div>
                                </div>
                                <span class="badge bg-${c.status === 'New' ? 'warning' : (c.status === 'Resolved' ? 'success' : 'secondary')}">${c.status}</span>
                            </div>
                            <div class="mt-2">${(c.description || '').substring(0, 140)}...</div>
                        </div>`;
                    container.appendChild(card);
                });
            } catch (e) {
                container.textContent = 'Error loading messages.';
            }
        });
    </script>

<script>
    // Add some interactivity
    document.addEventListener('DOMContentLoaded', function() {
        // Animate stat numbers on load
        const statNumbers = document.querySelectorAll('.stat-number');
        statNumbers.forEach(stat => {
            const finalNumber = parseInt(stat.textContent.replace(',', ''));
            let currentNumber = 0;
            const increment = finalNumber / 50;
            
            const timer = setInterval(() => {
                currentNumber += increment;
                if (currentNumber >= finalNumber) {
                    stat.textContent = finalNumber.toLocaleString();
                    clearInterval(timer);
                } else {
                    stat.textContent = Math.floor(currentNumber).toLocaleString();
                }
            }, 30);
        });
    });
</script>